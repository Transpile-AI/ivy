import paddle
from collections import Counter

def mode(data):
    """
    Find the mode (most frequent element) in a PaddlePaddle tensor.

    Args:
        data (paddle.Tensor): The input tensor.

    Returns:
        paddle.Tensor: The mode of the input tensor.
    """
    # Convert the PaddlePaddle tensor to a NumPy array for easier manipulation
    data_np = data.numpy()
    
    # Use Counter to count the occurrences of each element
    counts = Counter(data_np)
    
    # Find the most common element(s)
    mode_elements = counts.most_common(1)
    
    # Return the mode as a PaddlePaddle tensor
    return paddle.to_tensor(mode_elements[0][0])


if __name__ == "__main__":
    data = paddle.to_tensor([1, 2, 2, 3, 4, 4, 4, 5])

    result = mode(data)
    print("Mode:", result.numpy())
